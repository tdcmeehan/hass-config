welcome_home:
  sequence:
    - service: alarm_control_panel.alarm_disarm
      entity_id: alarm_control_panel.simplisafe
      data:
        code: !secret simplisafe_code
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon' 
    - service: homeassistant.turn_on
      entity_id: scene.arrive_home
 
goodbye:
  sequence:
    - service: homeassistant.turn_off
      entity_id: group.all_switches_and_lights
    - condition: and
      conditions:
        - condition: state
          entity_id: group.family
          state: 'not_home'
          for: 
            minutes: 30
        - condition: state
          entity_id: alarm_control_panel.simplisafe
          state: 'disarmed'
    - service: notify.notify
      data: 
        message: "Alarm is still disarmed!"
        data:
          url: https://doremus.timdmeehan.com/states/group.home_status

wake_up:
  sequence:
    - service: homeassistant.turn_on
      entity_id: scene.wake_up

good_night:
  sequence:
    - service: homeassistant.turn_off
      entity_id: group.downstairs_lights

alarm_state_change:
  sequence:
    - condition: template
      value_template: >
        {% if is_state('alarm_control_panel.simplisafe', 'unknown') %}
          false
        {% else %}
          true
        {% endif %}
    - service: notify.pushbullet
      data_template:
        message: "Alarm is now {{ states('alarm_control_panel.simplisafe') }}"
        target:
          - "device/tim"
    - condition: or
      conditions:
        - condition: time
          after: '06:50:00'
        - condition: time
          before: '06:00:00'
    - service: notify.pushbullet
      data_template:
        message: "Alarm is now {{ states('alarm_control_panel.simplisafe') }}"
        target:
          - !secret diana_pushbullet

